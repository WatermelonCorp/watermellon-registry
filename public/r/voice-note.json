{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "voice-note",
  "dependencies": [
    "motion",
    "lucide-react",
    "react-icons"
  ],
  "files": [
    {
      "path": "src/components/ui/voice-note.tsx",
      "content": "import React, { useState, useEffect, useRef } from 'react';\nimport { motion, AnimatePresence } from 'motion/react';\nimport { Mic, X, Play, Square, Sun, Moon } from 'lucide-react';\nimport { RiSendPlaneFill } from 'react-icons/ri';\nimport { FaCheck } from 'react-icons/fa6';\n\nenum RecorderState {\n    IDLE = 'IDLE',\n    RECORDING = 'RECORDING',\n    REVIEWING = 'REVIEWING',\n    PLAYING = 'PLAYING',\n}\n\ninterface VoiceNoteRecorderProps {\n    onSend?: (data: { duration: number; blob: Blob | null }) => void;\n    onCancel?: () => void;\n    maxDuration?: number;\n}\n\nexport const VoiceNote: React.FC<VoiceNoteRecorderProps> = ({\n    onSend,\n    onCancel,\n    maxDuration = 4,\n}) => {\n    const [state, setState] = useState<RecorderState>(RecorderState.IDLE);\n    const [duration, setDuration] = useState(0);\n    const [playbackTime, setPlaybackTime] = useState(0);\n    const [theme, setTheme] = useState<'light' | 'dark'>('light');\n\n    const isDark = theme === 'dark';\n    const timerRef = useRef<ReturnType<typeof setInterval> | null>(null);\n    const playbackTimerRef = useRef<ReturnType<typeof setInterval> | null>(null);\n\n    const spring = { type: 'spring', stiffness: 400, damping: 30 } as const;\n\n    const startRecording = () => {\n        setState(RecorderState.RECORDING);\n        setDuration(0);\n        timerRef.current = setInterval(() => {\n            setDuration(prev => {\n                if (prev >= maxDuration) {\n                    stopRecording();\n                    return prev;\n                }\n                return prev + 1;\n            });\n        }, 1000);\n    };\n\n    const stopRecording = () => {\n        if (timerRef.current) clearInterval(timerRef.current);\n        setState(RecorderState.REVIEWING);\n    };\n\n    const cancelRecording = () => {\n        if (timerRef.current) clearInterval(timerRef.current);\n        if (playbackTimerRef.current) clearInterval(playbackTimerRef.current);\n        setDuration(0);\n        setPlaybackTime(0);\n        setState(RecorderState.IDLE);\n        onCancel?.();\n    };\n\n    const startPlayback = () => {\n        setState(RecorderState.PLAYING);\n        setPlaybackTime(duration);\n        playbackTimerRef.current = setInterval(() => {\n            setPlaybackTime(prev => {\n                if (prev <= 0) {\n                    stopPlayback();\n                    return 0;\n                }\n                return prev - 1;\n            });\n        }, 1000);\n    };\n\n    const stopPlayback = () => {\n        if (playbackTimerRef.current) clearInterval(playbackTimerRef.current);\n        setPlaybackTime(0);\n        setState(RecorderState.REVIEWING);\n    };\n\n    const handleSend = () => {\n        onSend?.({ duration, blob: null });\n        cancelRecording();\n    };\n\n    const formatTime = (s: number) => `${s.toString().padStart(2, '0')}s`;\n\n    useEffect(() => {\n        return () => {\n            if (timerRef.current) clearInterval(timerRef.current);\n            if (playbackTimerRef.current) clearInterval(playbackTimerRef.current);\n        };\n    }, []);\n\n   \n    const colors = {\n        bg: isDark ? 'bg-[#0f0f12]' : 'bg-white',\n        widgetBg: isDark ? 'bg-[#1a1a1e]' : 'bg-[#fefefe]',\n        border: isDark ? 'border-[#2d2d33]' : 'border-[#E8E7EF]',\n        text: isDark ? 'text-[#fefefe]' : 'text-slate-700',\n        micIcon: isDark ? 'text-[#fefefe]' : 'text-slate-800',\n        timeText: isDark ? 'text-[#fefefe]' : 'text-[#282828]',\n        sendIcon: isDark ? '#fefefe' : '#272727',\n        toggleBtn: isDark ? 'bg-[#1a1a1e] text-yellow-400 border-[#2d2d33]' : 'bg-white text-slate-600 border-[#E8E7EF]'\n    };\n\n    const actionBtnClass = `w-16 h-16 rounded-full border-[1.6px] shadow-sm flex items-center justify-center shrink-0 transition-colors duration-300 ${colors.widgetBg} ${colors.border}`;\n\n    return (\n    <div className={`min-h-screen flex flex-col items-center justify-center p-8 space-y-12 transition-colors duration-500 ${colors.bg}`}>\n        \n        {/* Theme Toggle Button */}\n        <motion.button \n            onClick={() => setTheme(isDark ? 'light' : 'dark')}\n            whileTap={{ scale: 0.9 }}\n            className={`p-3 rounded-full border shadow-sm transition-all ${colors.toggleBtn}`}\n        >\n            {isDark ? <Sun size={20} /> : <Moon size={20} />}\n        </motion.button>\n\n        <div className=\"flex items-center gap-3\">\n            <AnimatePresence mode='popLayout'>\n                {state !== RecorderState.IDLE && (\n                    <motion.button\n                        key=\"cancel-btn\"\n                        initial={{ scale: 0.8, opacity: 0 }}\n                        animate={{ scale: 1, opacity: 1 }}\n                        exit={{ scale: 0.8, opacity: 0 }}\n                        transition={spring}\n                        onClick={cancelRecording}\n                        className={actionBtnClass}\n                    >\n                        <X size={28} className={colors.text} />\n                    </motion.button>\n                )}\n            </AnimatePresence>\n\n            {/* CENTER WIDGET */}\n            <motion.div\n                layout\n                transition={spring}\n                className={`\n                    relative flex items-center justify-center overflow-hidden shadow-sm transition-colors duration-300\n                    ${state === RecorderState.IDLE ? 'w-16 h-16' : 'h-16 px-6'} \n                    rounded-full border-[1.6px] ${colors.border}\n                    ${state === RecorderState.RECORDING ? (isDark ? 'bg-[#441010] border-none' : 'bg-[#FEE5E4] border-none') : colors.widgetBg}\n                `}\n            >\n                {/* Progress Border for Recording */}\n                <AnimatePresence>\n                    {state === RecorderState.RECORDING && (\n                        <svg className=\"absolute inset-0 w-full h-full pointer-events-none\">\n                            <motion.rect\n                                x=\"2\"\n                                y=\"2\"\n                                rx=\"30\"\n                                width=\"calc(100% - 4px)\"\n                                height=\"calc(100% - 4px)\"\n                                fill=\"none\"\n                                stroke=\"#ef4444\"\n                                strokeWidth=\"3\"\n                                pathLength={1}\n                                strokeDasharray=\"1\"\n                                strokeDashoffset=\"1\"\n                                strokeLinecap=\"round\"\n                                initial={{ strokeDashoffset: 1 }}\n                                animate={{ strokeDashoffset: 0 }}\n                                transition={{\n                                    duration: maxDuration,\n                                    ease: \"linear\",\n                                }}\n                            />\n                        </svg>\n                    )}\n                </AnimatePresence>\n\n                <AnimatePresence mode=\"popLayout\">\n                    {/* IDLE MIC */}\n                    {state === RecorderState.IDLE && (\n                        <motion.button\n                            key=\"mic-icon\"\n                            initial={{ opacity: 0, scale: 0.8 }}\n                            animate={{ opacity: 1, scale: 1 }}\n                            exit={{ opacity: 0, scale: 0.8 }}\n                            transition={{ duration: 0.2 }}\n                            onClick={startRecording}\n                            className=\"flex items-center justify-center\"\n                        >\n                            <Mic size={28} className={colors.micIcon} />\n                        </motion.button>\n                    )}\n\n                    {/* RECORDING BARS */}\n                    {state === RecorderState.RECORDING && (\n                        <motion.div\n                            key=\"recording-ui\"\n                            initial={{ opacity: 0 }}\n                            animate={{ opacity: 1 }}\n                            exit={{ opacity: 0 }}\n                            className=\"flex items-center gap-1.5 z-10\"\n                        >\n                            {[1, 2, 3, 4, 5, 6].map(i => (\n                                <motion.div\n                                    key={i}\n                                    animate={{ height: [10, 22, 14, 28, 16][i % 5] }}\n                                    transition={{\n                                        duration: 0.4,\n                                        repeat: Infinity,\n                                        repeatType: 'reverse',\n                                        delay: i * 0.04,\n                                    }}\n                                    className=\"w-1.5 rounded-full bg-[#FC3229]\"\n                                />\n                            ))}\n                        </motion.div>\n                    )}\n\n                    {/* REVIEW / PLAYBACK */}\n                    {(state === RecorderState.REVIEWING || state === RecorderState.PLAYING) && (\n                        <motion.div\n                            key=\"review-ui\"\n                            initial={{ opacity: 0, y: 5 }}\n                            animate={{ opacity: 1, y: 0 }}\n                            exit={{ opacity: 0, y: -5 }}\n                            className=\"flex items-center gap-2 z-10\"\n                        >\n                            <button\n                                onClick={state === RecorderState.PLAYING ? stopPlayback : startPlayback}\n                                className={`w-10 h-10 rounded-full flex items-center justify-center transition-colors\n                                    ${state === RecorderState.PLAYING ? (isDark ? 'bg-red-900/40 text-red-400' : 'bg-red-100 text-red-500') : colors.micIcon}\n                                `}\n                            >\n                                {state === RecorderState.PLAYING ? (\n                                    <Square size={22} fill=\"currentColor\" />\n                                ) : (\n                                    <Play size={22} fill=\"currentColor\" />\n                                )}\n                            </button>\n                            <span className={`text-[20px] font-bold tabular-nums transition-colors ${colors.timeText}`}>\n                                {formatTime(state === RecorderState.PLAYING ? playbackTime : duration)}\n                            </span>\n                        </motion.div>\n                    )}\n                </AnimatePresence>\n            </motion.div>\n\n            {/* ACTION BUTTONS */}\n            <AnimatePresence mode='popLayout'>\n                {state === RecorderState.RECORDING && (\n                    <motion.button\n                        key=\"check-btn\"\n                        initial={{ scale: 0.8, opacity: 0 }}\n                        animate={{ scale: 1, opacity: 1 }}\n                        exit={{ scale: 0.8, opacity: 0 }}\n                        transition={spring}\n                        onClick={stopRecording}\n                        className={actionBtnClass}\n                    >\n                        <FaCheck size={26} className={colors.text} />\n                    </motion.button>\n                )}\n\n                {(state === RecorderState.REVIEWING || state === RecorderState.PLAYING) && (\n                    <motion.button\n                        key=\"send-btn\"\n                        initial={{ scale: 0.8, opacity: 0 }}\n                        animate={{ scale: 1, opacity: 1 }}\n                        exit={{ scale: 0.8, opacity: 0 }}\n                        transition={spring}\n                        onClick={handleSend}\n                        className={actionBtnClass}\n                    >\n                        <RiSendPlaneFill size={26} color={colors.sendIcon} />\n                    </motion.button>\n                )}\n            </AnimatePresence>\n        </div>\n    </div>\n    );\n};",
      "type": "registry:ui",
      "target": "components/ui/voice-note.tsx"
    }
  ],
  "type": "registry:ui"
}